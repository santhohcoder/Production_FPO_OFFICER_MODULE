<style>

#overlay {
   position: fixed;
   left: 0%;
   top: 0%;
   z-index: 9999;
    width: 100%;
    background: rgba(255, 255, 255, .7);
    height: 100%;
        }
  #loader {
    position: fixed;
    display: block;
     left: 50%;
     top: 48%;
     z-index: 9999;
     width: 100%;
      height: 100%;
      background-image: url(images/report/loader.gif);
     background-repeat: no-repeat;
     margin: -77px 0 0 -75px;
        }
</style>

<div id="overlay" style="display: none;">
        <div id="loader">
        <div style="font-size: 20px; padding-top:5%"><b>Please wait...</b>
</div>   </div> </div>
<div id="queryQueueshow" class="col-md-12">
			<div align="center">
				<p>
					<!-- <strong >Query Queue</strong> -->
				</p>
			</div>
			
			
			<a title="Excel">
				<button id="ExcelExport" class="btn btn-primary" style="font-size:15px">Export to Excel <i class="fas fa-file-excel" aria-hidden="true"></i></button>
				</a>
			<!-- <input type="hidden" th:value="${reportcounts.custitm}" id="custitmcount" >
			<input type="hidden" th:value="${reportcounts.arrival}" id="arrivalcount" >
			<input type="hidden" th:value="${reportcounts.ooc}" id="ooccount" >
			<input type="hidden" th:value="${reportcounts.delivery}" id="deliverycount" >
			<input type="hidden" th:value="${reportcounts.cusrsp}" id="cusrspcount" > -->

			 <table id="processtable" class="table table-striped table-bordered newtable"
               style="font-size: 16px; text-align: center;width: 100%;">
               <thead style="background-color: #a1c4e6;">
                  <tr>
                     <th scope="col" id="sinid" style="width: 45px;">Sl.No.</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Article Id</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Posting Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Country Of Origin</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Sender Name</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Sender Address</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Receiver Name</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Receiver Address</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">State</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Pin Code</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">EAD Decision</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Mail class</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Item Category</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Gross Weight</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Item No</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Item Description</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">HS Code in CN23</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Revised HS Code in CN23</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">CTH Assessed</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Value Declared in CN23</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Currency Code</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Exchange Rate</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Assessed Value</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Query</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">D-Call Letter No</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">D-Call Letter Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Speed Post No</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Speed Post Delivery Status</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Reply</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Time Taken To Reply</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Reply IP</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Total Duty</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Amount Payable</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Fine</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Penalty</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Arrival OOE</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Arrival Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Receptacle ID</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Destination FPO</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Destination FPO Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Bag No</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Exam Order</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Exam Finding</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Examination Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">OOC</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Commercial Import Queue</th>
                     <!-- <th class="tablecolumn" scope="col" style="text-align: center;">Response From EDI (EDI OOC)</th> -->
                     <th class="tablecolumn" scope="col" style="text-align: center;">Detention</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Delivery Date</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Delivery Acknowledgement</th>
                     <th class="tablecolumn" scope="col" style="text-align: center;">Delivery Status</th>
                     <!-- <th class="tablecolumn" scope="col" style="text-align: center;">RMS</th> -->
                  </tr>
               </thead>
               <tbody>
                  <tr th:each="values: ${reportcolumns}" class="" >
                     <td class="" th:text="${values.id}"></td>
                     <td class="tablecolumn" th:text="${values.item_id}"></td>
                     <td class="tablecolumn" th:text="${values.post_dt}"></td>
                     <td class="tablecolumn" th:text="${values.coo}"></td>
                     <td class="tablecolumn" th:text="${values.sender_name}"></td>
                     <td class="tablecolumn" th:text="${values.sender_addr}"></td>
                     <td class="tablecolumn" th:text="${values.recp_name}"></td>
                     <td class="tablecolumn" th:text="${values.rec_addr}"></td>
                     <td class="tablecolumn" th:text="${values.recp_state}"></td>
                     <td class="tablecolumn" th:text="${values.recp_zip}"></td>
                     <td class="tablecolumn" th:text="${values.deci_nm}"></td>
                     <td class="tablecolumn" th:text="${values.mail_class}"></td>
                     <td class="tablecolumn" th:text="${values.mail_category}"></td>
                     <td class="tablecolumn" th:text="${values.gross_wt}"></td>
                     <td class="tablecolumn" th:text="${values.item_no}"></td>
                     <td class="tablecolumn" th:text="${values.item_desc}"></td>
                     <td class="tablecolumn" th:text="${values.cn23}"></td>
                     <td class="tablecolumn" th:text="${values.revised_code}"></td>
                     <td class="tablecolumn" th:text="${values.cth}"></td>
                     <td class="tablecolumn" th:text="${values.item_vlue}"></td>
                     <td class="tablecolumn" th:text="${values.curr_cd}"></td>
                     <td class="tablecolumn" th:text="${values.ex_rate}"></td>
                     <td class="tablecolumn" th:text="${values.assessedval}"></td>
                     <td class="tablecolumn" th:text="${values.qry}"></td>
                     <td class="tablecolumn" th:text="${values.dcallno}"></td>
                     <td class="tablecolumn" th:text="${values.dcall_dt}"></td>
                     <td class="tablecolumn" th:text="${values.speedpostno}"></td>
                     <td class="tablecolumn" th:text="${values.speedpostdelstatus}"></td>
                     <td class="tablecolumn" th:text="${values.rply}"></td>
                     <td class="tablecolumn" th:text="${values.rlytime}"></td>
                     <td class="tablecolumn" th:text="${values.replyip}"></td>
                     <td class="tablecolumn" th:text="${values.duty}"></td>
                     <td class="tablecolumn" th:text="${values.tot_amt_payable}"></td>
                     <td class="tablecolumn" th:text="${values.fine_amt}"></td>
                     <td class="tablecolumn" th:text="${values.penal_amt}"></td>
                     <td class="tablecolumn" th:text="${values.arriaval_date}"></td>
                     <td class="tablecolumn" th:text="${values.arr_dt}"></td>
                     <td class="tablecolumn" th:text="${values.recp_id}"></td>
                     <td class="tablecolumn" th:text="${values.destfpo}"></td>
                     <td class="tablecolumn" th:text="${values.destfpo_dt}"></td>
                     <td class="tablecolumn" th:text="${values.bag_no}"></td>
                     <td class="tablecolumn" th:text="${values.examination}"></td>
                     <td class="tablecolumn" th:text="${values.examfind}"></td>
                     <td class="tablecolumn" th:text="${values.exam_dt}"></td>
                     <td class="tablecolumn" th:text="${values.ooc_dt}"></td>
                     <td class="tablecolumn" th:text="${values.QRY_DT}"></td>
                    <!--  <td class="tablecolumn" th:text="${values.respedi}"></td> -->
                     <td class="tablecolumn" th:text="${values.detain_dt}"></td>
                     <td class="tablecolumn" th:text="${values.del_dt}"></td>
                     <td class="tablecolumn" th:text="${values.delivery_date}"></td>
                     <td class="tablecolumn" th:text="${values.deliverystatus}"></td>
                     <!-- <td class="tablecolumn" th:text="${values.rms}"></td> -->
                  </tr>
               </tbody>
            </table>
		</div>
		<script  th:inline="javascript" >
		$(document).ready(function() {
    $("#processtable").dataTable({
        "processing": true,
        "paging": false,
        scrollY: 500,
        scrollX: true,
		"ordering" :false,
        "dom": 'Bfrtip',
        buttons: [{
            text: 'Export to XLS',
            extend: 'excelHtml5',
            exportOptions: {
                columns: ':visible'
            }
        }]
    });

	$('#processtable').DataTable().on('order.dt search.dt', function() {
	        $('#processtable').DataTable().column(0, {
	            search: 'applied',
	            order: 'applied'
	        }).nodes().each(function(cell, i) {
	            cell.innerHTML = i + 1;
	        });
	    }).draw();
    
    
$("#ExcelExport").on('click',function(){
  	    	  $(".buttons-excel").trigger('click'); 
			  //$(".buttons-print").trigger('click'); 
  	    	this.blur();
  	      });


$('#processtable').DataTable().columns([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30 , 31, 32 ,33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]).visible(false);

	columnsarray=JSON.parse(localStorage.getItem("columns"));
 columnsname=JSON.parse(localStorage.getItem("columns"));
columnsname.forEach(function(el, index) {
   

if ($('#'+el).hasClass("columnselect")) {
    $('#processtable').DataTable().column(el).visible(true);
} else {
    $('#processtable').DataTable().column(el).visible(false);
	}
});
if($("#processtable").dataTable().fnGetData().length > 0){
		 $("#ExcelExport").css("display", "block");
		 // $("#selectall").css("display", "block");
	}else{
		 $("#ExcelExport").css("display", "none");
		// $("#selectall").css("display", "none");
	}
    
});
 function showLoader() {
	$("#overlay").css("display", "block");
	$('#overlay').height($("body").innerHeight());
}

function hideLoader() {
	setTimeout(function() {
		$("#overlay").css("display", "none");
	}, 500);
}
</script>